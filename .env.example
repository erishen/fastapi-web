# FastAPI Web 应用环境配置

# 应用环境
APP_ENV=development

# 服务器配置
PORT=8080
HOST=0.0.0.0

# 数据库配置
# MySQL 数据库配置（本地开发）
MYSQL_HOST=127.0.0.1
MYSQL_PORT=3306
MYSQL_USER=fastapi
MYSQL_PASSWORD=mysql123
MYSQL_DATABASE=fastapi_web
DATABASE_URL=mysql+pymysql://${MYSQL_USER}:${MYSQL_PASSWORD}@${MYSQL_HOST}:${MYSQL_PORT}/${MYSQL_DATABASE}

# SQLite 数据库（备用）
# DATABASE_URL=sqlite:///./app.db

# PostgreSQL 数据库配置示例
# DATABASE_URL=postgresql://username:yourpassword@localhost:5432/fastapi_db

# Redis 配置
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=redis123
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:${REDIS_PORT}/${REDIS_DB}

# 应用配置
DEBUG=true
LOG_LEVEL=info

# API 配置
PROJECT_NAME=FastAPI Web Application
VERSION=1.0.0

# 安全配置
SECRET_KEY=your-jwt-secret-key-1234567890abcdef
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# NextAuth 集成配置
# NextAuth JWT secret（用于验证 NextAuth token）
NEXTAUTH_SECRET=your-nextauth-secret-1234567890abcdef
# 允许访问 FastAPI 的 admin 邮箱列表（逗号分隔）
NEXTAUTH_ADMIN_EMAILS=admin@example.com

# 管理员凭据（备用密码登录方式）
ADMIN_USERNAME=admin
# 注意：密码哈希必须用单引号包围，避免 $ 符号被 shell 解析
# python generate_password_hash.py admin123
ADMIN_PASSWORD_HASH='$pbkdf2-sha256$30000$AyDEeO8d47w3JkQohdD6/w$1g9oXRD4yT8sfrBpvfOa14t1Y9Zo/PkPyO0VqiPLp6Y'
ADMIN_PASSWORD=admin123

# CORS 配置
ALLOWED_HOSTS=["localhost", "127.0.0.1", "0.0.0.0"]
ALLOWED_ORIGINS=["http://localhost:3000", "http://localhost:8080", "http://127.0.0.1:8080"]

# 数据库连接池配置
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# 缓存配置
CACHE_EXPIRE_SECONDS=3600

# 文档日志 API 保护配置
DOC_LOG_API_KEY=doc-log-api-key-123456
DOC_LOG_RATE_LIMIT=100  # 每分钟最多100次请求
DOC_LOG_RATE_LIMIT_WINDOW=60  # 时间窗口（秒）

# 速率限制配置
RATE_LIMIT_REQUESTS=100  # 默认速率限制：每100秒100次请求
RATE_LIMIT_WINDOW=60  # 时间窗口（秒）
RATE_LIMIT_STRICT_REQUESTS=20  # 严格速率限制：每60秒20次请求
RATE_LIMIT_STRICT_WINDOW=60  # 严格模式时间窗口（秒）
RATE_LIMIT_LOGIN_REQUESTS=30  # 登录速率限制：每60秒30次请求
RATE_LIMIT_LOGIN_WINDOW=60  # 登录模式时间窗口（秒）

# IP 黑名单/白名单配置
# 黑名单（逗号分隔的 IP 或 CIDR，例如：192.168.1.0/24, 10.0.0.1）
IP_BLACKLIST=
# 白名单（逗号分隔的 IP 或 CIDR，如果设置了白名单，则只允许白名单中的 IP 访问）
IP_WHITELIST=

# 自动黑名单配置（基于异常行为检测）
AUTO_BLACKLIST_THRESHOLD=500  # 5分钟内超过500次请求自动加入黑名单
AUTO_BLACKLIST_WINDOW=300  # 时间窗口（秒）
IP_CLEANUP_INTERVAL=600  # IP 统计清理间隔（秒）

# 路径保护配置
PATH_PROTECTION_STRICT=false  # 严格模式：阻止所有可疑路径（包括 admin、login 等）

# 日志配置
LOG_FILE=./logs/app.log
LOG_MAX_SIZE=10MB
LOG_BACKUP_COUNT=5